Shape of X [N, C, H, W]: torch.Size([64, 1, 28, 28])
Shape of y: torch.Size([64]) torch.int64
Using cuda device
NeuralNetwork(
  (flatten): Flatten(start_dim=1, end_dim=-1)
  (linear_relu_stack): Sequential(
    (0): Linear(in_features=784, out_features=512, bias=True)
    (1): ReLU()
    (2): Linear(in_features=512, out_features=512, bias=True)
    (3): ReLU()
    (4): Linear(in_features=512, out_features=10, bias=True)
  )
)
Sequential(
  (0): Lambda()
  (1): Conv2d(1, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (2): ReLU()
  (3): Conv2d(16, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (4): ReLU()
  (5): Conv2d(16, 10, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (6): ReLU()
  (7): AvgPool2d(kernel_size=4, stride=4, padding=0)
  (8): Lambda()
)
Epoch 1
-------------------------------
loss: 2.300757  [   64/60000]
loss: 2.300498  [ 6464/60000]
loss: 2.303552  [12864/60000]
loss: 2.305095  [19264/60000]
loss: 2.304106  [25664/60000]
loss: 2.299217  [32064/60000]
loss: 2.293360  [38464/60000]
loss: 2.303245  [44864/60000]
loss: 2.303700  [51264/60000]
loss: 2.301205  [57664/60000]
Test Error: 
 Accuracy: 13.2%, Avg loss: 2.299007 

Epoch 2
-------------------------------
loss: 2.296365  [   64/60000]
loss: 2.294555  [ 6464/60000]
loss: 2.302300  [12864/60000]
loss: 2.305236  [19264/60000]
loss: 2.302795  [25664/60000]
loss: 2.295612  [32064/60000]
loss: 2.285747  [38464/60000]
loss: 2.300964  [44864/60000]
loss: 2.301570  [51264/60000]
loss: 2.298628  [57664/60000]
Test Error: 
 Accuracy: 16.3%, Avg loss: 2.293960 

Epoch 3
-------------------------------
loss: 2.289655  [   64/60000]
loss: 2.287079  [ 6464/60000]
loss: 2.299373  [12864/60000]
loss: 2.304061  [19264/60000]
loss: 2.299657  [25664/60000]
loss: 2.290286  [32064/60000]
loss: 2.268670  [38464/60000]
loss: 2.295951  [44864/60000]
loss: 2.296839  [51264/60000]
loss: 2.289630  [57664/60000]
Test Error: 
 Accuracy: 19.3%, Avg loss: 2.282463 

Epoch 4
-------------------------------
loss: 2.273658  [   64/60000]
loss: 2.266384  [ 6464/60000]
loss: 2.291360  [12864/60000]
loss: 2.288755  [19264/60000]
loss: 2.288261  [25664/60000]
loss: 2.276012  [32064/60000]
loss: 2.229524  [38464/60000]
loss: 2.292190  [44864/60000]
loss: 2.271778  [51264/60000]
loss: 2.257073  [57664/60000]
Test Error: 
 Accuracy: 19.9%, Avg loss: 2.248544 

Epoch 5
-------------------------------
loss: 2.230010  [   64/60000]
loss: 2.214023  [ 6464/60000]
loss: 2.246537  [12864/60000]
loss: 2.259822  [19264/60000]
loss: 2.237600  [25664/60000]
loss: 2.220403  [32064/60000]
loss: 2.127410  [38464/60000]
loss: 2.262311  [44864/60000]
loss: 2.218726  [51264/60000]
loss: 2.199466  [57664/60000]
Test Error: 
 Accuracy: 29.8%, Avg loss: 2.152971 

Epoch 6
-------------------------------
loss: 2.118837  [   64/60000]
loss: 2.097306  [ 6464/60000]
loss: 2.113376  [12864/60000]
loss: 2.186563  [19264/60000]
loss: 2.036992  [25664/60000]
loss: 2.054861  [32064/60000]
loss: 1.930937  [38464/60000]
loss: 2.148202  [44864/60000]
loss: 2.052926  [51264/60000]
loss: 2.013905  [57664/60000]
Test Error: 
 Accuracy: 38.1%, Avg loss: 1.911153 

Epoch 7
-------------------------------
loss: 1.893149  [   64/60000]
loss: 1.895979  [ 6464/60000]
loss: 1.906537  [12864/60000]
loss: 2.013421  [19264/60000]
loss: 1.700684  [25664/60000]
loss: 1.733673  [32064/60000]
loss: 1.630749  [38464/60000]
loss: 2.025251  [44864/60000]
loss: 1.958055  [51264/60000]
loss: 1.820842  [57664/60000]
Test Error: 
 Accuracy: 45.6%, Avg loss: 1.739875 

Epoch 8
-------------------------------
loss: 1.742425  [   64/60000]
loss: 1.746548  [ 6464/60000]
loss: 1.746616  [12864/60000]
loss: 1.909583  [19264/60000]
loss: 1.490375  [25664/60000]
loss: 1.547624  [32064/60000]
loss: 1.480326  [38464/60000]
loss: 1.891206  [44864/60000]
loss: 1.834356  [51264/60000]
loss: 1.614698  [57664/60000]
Test Error: 
 Accuracy: 50.6%, Avg loss: 1.608497 

Epoch 9
-------------------------------
loss: 1.603402  [   64/60000]
loss: 1.600307  [ 6464/60000]
loss: 1.556611  [12864/60000]
loss: 1.796052  [19264/60000]
loss: 1.327791  [25664/60000]
loss: 1.357414  [32064/60000]
loss: 1.339532  [38464/60000]
loss: 1.795400  [44864/60000]
loss: 1.709286  [51264/60000]
loss: 1.457984  [57664/60000]
Test Error: 
 Accuracy: 53.4%, Avg loss: 1.506889 

Epoch 10
-------------------------------
loss: 1.473669  [   64/60000]
loss: 1.455123  [ 6464/60000]
loss: 1.416819  [12864/60000]
loss: 1.707256  [19264/60000]
loss: 1.216310  [25664/60000]
loss: 1.217570  [32064/60000]
loss: 1.203534  [38464/60000]
loss: 1.702462  [44864/60000]
loss: 1.561045  [51264/60000]
loss: 1.357042  [57664/60000]
Test Error: 
 Accuracy: 58.0%, Avg loss: 1.389959 

Done!
Time-consuming: 157.97039556503296 

Saved PyTorch CNN Model State to {model_path}
