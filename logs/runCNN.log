1684575306.0722647
Shape of X [N, C, H, W]: torch.Size([64, 1, 28, 28])
Shape of y: torch.Size([64]) torch.int64
show image
Using cuda device
CNN(
  (CNN_stack): Sequential(
    (0): Conv2d(1, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU()
    (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (3): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (4): ReLU()
    (5): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (flatten): Flatten(start_dim=1, end_dim=-1)
  (linear_stack): Sequential(
    (0): Linear(in_features=3136, out_features=1024, bias=True)
    (1): ReLU()
    (2): Linear(in_features=1024, out_features=512, bias=True)
    (3): Dropout(p=0.5, inplace=False)
    (4): ReLU()
    (5): Linear(in_features=512, out_features=10, bias=True)
  )
)
Epoch 1
-------------------------------
train_step:1     loss: 2.303320  [   64/60000]
train_step:101   loss: 2.271730  [ 6464/60000]
train_step:201   loss: 2.236160  [12864/60000]
train_step:301   loss: 2.088497  [19264/60000]
train_step:401   loss: 1.543394  [25664/60000]
train_step:501   loss: 0.956903  [32064/60000]
train_step:601   loss: 0.592293  [38464/60000]
train_step:701   loss: 0.701926  [44864/60000]
train_step:801   loss: 0.593816  [51264/60000]
train_step:901   loss: 0.476196  [57664/60000]
Test Error: 
 Accuracy: 89.9%, Avg loss: 0.343797

Epoch 2
-------------------------------
train_step:939   loss: 0.391661  [   64/60000]
train_step:1039          loss: 0.292118  [ 6464/60000]
train_step:1139          loss: 0.250069  [12864/60000]
train_step:1239          loss: 0.383515  [19264/60000]
train_step:1339          loss: 0.202141  [25664/60000]
train_step:1439          loss: 0.355166  [32064/60000]
train_step:1539          loss: 0.149375  [38464/60000]
train_step:1639          loss: 0.424380  [44864/60000]
train_step:1739          loss: 0.338522  [51264/60000]
train_step:1839          loss: 0.287977  [57664/60000]
Test Error: 
 Accuracy: 94.7%, Avg loss: 0.170422

Epoch 3
-------------------------------
train_step:1877          loss: 0.157615  [   64/60000]
train_step:1977          loss: 0.131888  [ 6464/60000]
train_step:2077          loss: 0.147235  [12864/60000]
train_step:2177          loss: 0.304254  [19264/60000]
train_step:2277          loss: 0.112590  [25664/60000]
train_step:2377          loss: 0.224101  [32064/60000]
train_step:2477          loss: 0.076125  [38464/60000]
train_step:2577          loss: 0.321806  [44864/60000]
train_step:2677          loss: 0.269451  [51264/60000]
train_step:2777          loss: 0.233420  [57664/60000]
Test Error: 
 Accuracy: 96.7%, Avg loss: 0.107587

Epoch 4
-------------------------------
train_step:2815          loss: 0.142630  [   64/60000]
train_step:2915          loss: 0.126736  [ 6464/60000]
train_step:3015          loss: 0.148997  [12864/60000]
train_step:3115          loss: 0.204794  [19264/60000]
train_step:3215          loss: 0.059713  [25664/60000]
train_step:3315          loss: 0.169204  [32064/60000]
train_step:3415          loss: 0.085860  [38464/60000]
train_step:3515          loss: 0.237865  [44864/60000]
train_step:3615          loss: 0.165407  [51264/60000]
train_step:3715          loss: 0.199827  [57664/60000]
Test Error: 
 Accuracy: 97.5%, Avg loss: 0.080018

Epoch 5
-------------------------------
train_step:3753          loss: 0.114471  [   64/60000]
train_step:3853          loss: 0.127017  [ 6464/60000]
train_step:3953          loss: 0.121704  [12864/60000]
train_step:4053          loss: 0.155054  [19264/60000]
train_step:4153          loss: 0.102390  [25664/60000]
train_step:4253          loss: 0.115639  [32064/60000]
train_step:4353          loss: 0.083267  [38464/60000]
train_step:4453          loss: 0.194644  [44864/60000]
train_step:4553          loss: 0.161173  [51264/60000]
train_step:4653          loss: 0.199097  [57664/60000]
Test Error: 
 Accuracy: 97.9%, Avg loss: 0.066438

Epoch 6
-------------------------------
train_step:4691          loss: 0.078051  [   64/60000]
train_step:4791          loss: 0.112269  [ 6464/60000]
train_step:4891          loss: 0.092546  [12864/60000]
train_step:4991          loss: 0.153426  [19264/60000]
train_step:5091          loss: 0.052557  [25664/60000]
train_step:5191          loss: 0.119316  [32064/60000]
train_step:5291          loss: 0.082918  [38464/60000]
train_step:5391          loss: 0.147850  [44864/60000]
train_step:5491          loss: 0.170620  [51264/60000]
train_step:5591          loss: 0.163704  [57664/60000]
Test Error: 
 Accuracy: 98.1%, Avg loss: 0.058220

Epoch 7
-------------------------------
train_step:5629          loss: 0.056725  [   64/60000]
train_step:5729          loss: 0.074206  [ 6464/60000]
train_step:5829          loss: 0.081243  [12864/60000]
train_step:5929          loss: 0.058538  [19264/60000]
train_step:6029          loss: 0.044783  [25664/60000]
train_step:6129          loss: 0.087913  [32064/60000]
train_step:6229          loss: 0.055786  [38464/60000]
train_step:6329          loss: 0.143506  [44864/60000]
train_step:6429          loss: 0.116899  [51264/60000]
train_step:6529          loss: 0.140362  [57664/60000]
Test Error: 
 Accuracy: 98.3%, Avg loss: 0.051624

Epoch 8
-------------------------------
train_step:6567          loss: 0.057120  [   64/60000]
train_step:6667          loss: 0.094915  [ 6464/60000]
train_step:6767          loss: 0.038307  [12864/60000]
train_step:6867          loss: 0.092756  [19264/60000]
train_step:6967          loss: 0.037557  [25664/60000]
train_step:7067          loss: 0.061694  [32064/60000]
train_step:7167          loss: 0.074962  [38464/60000]
train_step:7267          loss: 0.198435  [44864/60000]
train_step:7367          loss: 0.089284  [51264/60000]
train_step:7467          loss: 0.191074  [57664/60000]
Test Error: 
 Accuracy: 98.5%, Avg loss: 0.047717

Epoch 9
-------------------------------
train_step:7505          loss: 0.047188  [   64/60000]
train_step:7605          loss: 0.089171  [ 6464/60000]
train_step:7705          loss: 0.072557  [12864/60000]
train_step:7805          loss: 0.097639  [19264/60000]
train_step:7905          loss: 0.039548  [25664/60000]
train_step:8005          loss: 0.056975  [32064/60000]
train_step:8105          loss: 0.055941  [38464/60000]
train_step:8205          loss: 0.085627  [44864/60000]
train_step:8305          loss: 0.131560  [51264/60000]
train_step:8405          loss: 0.115853  [57664/60000]
Test Error: 
 Accuracy: 98.6%, Avg loss: 0.044656

Epoch 10
-------------------------------
train_step:8443          loss: 0.032390  [   64/60000]
train_step:8543          loss: 0.092680  [ 6464/60000]
train_step:8643          loss: 0.026800  [12864/60000]
train_step:8743          loss: 0.067841  [19264/60000]
train_step:8843          loss: 0.054620  [25664/60000]
train_step:8943          loss: 0.129760  [32064/60000]
train_step:9043          loss: 0.067245  [38464/60000]
train_step:9143          loss: 0.094709  [44864/60000]
train_step:9243          loss: 0.118385  [51264/60000]
train_step:9343          loss: 0.161605  [57664/60000]
Test Error: 
 Accuracy: 98.6%, Avg loss: 0.042500

Epoch 11
-------------------------------
train_step:9381          loss: 0.030714  [   64/60000]
train_step:9481          loss: 0.120436  [ 6464/60000]
train_step:9581          loss: 0.053121  [12864/60000]
train_step:9681          loss: 0.044376  [19264/60000]
train_step:9781          loss: 0.029312  [25664/60000]
train_step:9881          loss: 0.061140  [32064/60000]
train_step:9981          loss: 0.052028  [38464/60000]
train_step:10081         loss: 0.099019  [44864/60000]
train_step:10181         loss: 0.091932  [51264/60000]
train_step:10281         loss: 0.123764  [57664/60000]
Test Error: 
 Accuracy: 98.7%, Avg loss: 0.039337

Epoch 12
-------------------------------
train_step:10319         loss: 0.035076  [   64/60000]
train_step:10419         loss: 0.085466  [ 6464/60000]
train_step:10519         loss: 0.039805  [12864/60000]
train_step:10619         loss: 0.054668  [19264/60000]
train_step:10719         loss: 0.049435  [25664/60000]
train_step:10819         loss: 0.057286  [32064/60000]
train_step:10919         loss: 0.081567  [38464/60000]
train_step:11019         loss: 0.095640  [44864/60000]
train_step:11119         loss: 0.077105  [51264/60000]
train_step:11219         loss: 0.091940  [57664/60000]
Test Error: 
 Accuracy: 98.7%, Avg loss: 0.038529

Epoch 13
-------------------------------
train_step:11257         loss: 0.029010  [   64/60000]
train_step:11357         loss: 0.088258  [ 6464/60000]
train_step:11457         loss: 0.050134  [12864/60000]
train_step:11557         loss: 0.039270  [19264/60000]
train_step:11657         loss: 0.040341  [25664/60000]
train_step:11757         loss: 0.045790  [32064/60000]
train_step:11857         loss: 0.071727  [38464/60000]
train_step:11957         loss: 0.075095  [44864/60000]
train_step:12057         loss: 0.117613  [51264/60000]
train_step:12157         loss: 0.138571  [57664/60000]
Test Error: 
 Accuracy: 98.8%, Avg loss: 0.035745

Epoch 14
-------------------------------
train_step:12195         loss: 0.019114  [   64/60000]
train_step:12295         loss: 0.137033  [ 6464/60000]
train_step:12395         loss: 0.055837  [12864/60000]
train_step:12495         loss: 0.069742  [19264/60000]
train_step:12595         loss: 0.035185  [25664/60000]
train_step:12695         loss: 0.047486  [32064/60000]
train_step:12795         loss: 0.040499  [38464/60000]
train_step:12895         loss: 0.092640  [44864/60000]
train_step:12995         loss: 0.105881  [51264/60000]
train_step:13095         loss: 0.105202  [57664/60000]
Test Error: 
 Accuracy: 98.8%, Avg loss: 0.034861

Epoch 15
-------------------------------
train_step:13133         loss: 0.013246  [   64/60000]
train_step:13233         loss: 0.151297  [ 6464/60000]
train_step:13333         loss: 0.039270  [12864/60000]
train_step:13433         loss: 0.039154  [19264/60000]
train_step:13533         loss: 0.015885  [25664/60000]
train_step:13633         loss: 0.017404  [32064/60000]
train_step:13733         loss: 0.067524  [38464/60000]
train_step:13833         loss: 0.040643  [44864/60000]
train_step:13933         loss: 0.079390  [51264/60000]
train_step:14033         loss: 0.039969  [57664/60000]
Test Error: 
 Accuracy: 98.8%, Avg loss: 0.033542

Epoch 16
-------------------------------
train_step:14071         loss: 0.020628  [   64/60000]
train_step:14171         loss: 0.102643  [ 6464/60000]
train_step:14271         loss: 0.044560  [12864/60000]
train_step:14371         loss: 0.051963  [19264/60000]
train_step:14471         loss: 0.011235  [25664/60000]
train_step:14571         loss: 0.031816  [32064/60000]
train_step:14671         loss: 0.052035  [38464/60000]
train_step:14771         loss: 0.032419  [44864/60000]
train_step:14871         loss: 0.083925  [51264/60000]
train_step:14971         loss: 0.117432  [57664/60000]
Test Error: 
 Accuracy: 98.9%, Avg loss: 0.032508

Epoch 17
-------------------------------
train_step:15009         loss: 0.011014  [   64/60000]
train_step:15109         loss: 0.078954  [ 6464/60000]
train_step:15209         loss: 0.018566  [12864/60000]
train_step:15309         loss: 0.025259  [19264/60000]
train_step:15409         loss: 0.031602  [25664/60000]
train_step:15509         loss: 0.009814  [32064/60000]
train_step:15609         loss: 0.066938  [38464/60000]
train_step:15709         loss: 0.048978  [44864/60000]
train_step:15809         loss: 0.077768  [51264/60000]
train_step:15909         loss: 0.080389  [57664/60000]
Test Error: 
 Accuracy: 98.9%, Avg loss: 0.031824

Epoch 18
-------------------------------
train_step:15947         loss: 0.006388  [   64/60000]
train_step:16047         loss: 0.059356  [ 6464/60000]
train_step:16147         loss: 0.046233  [12864/60000]
train_step:16247         loss: 0.025910  [19264/60000]
train_step:16347         loss: 0.017674  [25664/60000]
train_step:16447         loss: 0.029916  [32064/60000]
train_step:16547         loss: 0.065210  [38464/60000]
train_step:16647         loss: 0.031471  [44864/60000]
train_step:16747         loss: 0.097860  [51264/60000]
train_step:16847         loss: 0.071039  [57664/60000]
Test Error: 
 Accuracy: 98.9%, Avg loss: 0.030881

Epoch 19
-------------------------------
train_step:16885         loss: 0.006922  [   64/60000]
train_step:16985         loss: 0.053637  [ 6464/60000]
train_step:17085         loss: 0.030272  [12864/60000]
train_step:17185         loss: 0.013627  [19264/60000]
train_step:17285         loss: 0.006992  [25664/60000]
train_step:17385         loss: 0.014441  [32064/60000]
train_step:17485         loss: 0.068534  [38464/60000]
train_step:17585         loss: 0.029522  [44864/60000]
train_step:17685         loss: 0.119351  [51264/60000]
train_step:17785         loss: 0.083842  [57664/60000]
Test Error: 
 Accuracy: 99.0%, Avg loss: 0.029767

Epoch 20
-------------------------------
train_step:17823         loss: 0.011855  [   64/60000]
train_step:17923         loss: 0.091133  [ 6464/60000]
train_step:18023         loss: 0.037960  [12864/60000]
train_step:18123         loss: 0.054739  [19264/60000]
train_step:18223         loss: 0.014195  [25664/60000]
train_step:18323         loss: 0.009830  [32064/60000]
train_step:18423         loss: 0.041503  [38464/60000]
train_step:18523         loss: 0.034569  [44864/60000]
train_step:18623         loss: 0.102245  [51264/60000]
train_step:18723         loss: 0.069810  [57664/60000]
Test Error: 
 Accuracy: 99.0%, Avg loss: 0.029695

Epoch 21
-------------------------------
train_step:18761         loss: 0.010437  [   64/60000]
train_step:18861         loss: 0.033866  [ 6464/60000]
train_step:18961         loss: 0.029558  [12864/60000]
train_step:19061         loss: 0.011136  [19264/60000]
train_step:19161         loss: 0.013353  [25664/60000]
train_step:19261         loss: 0.017248  [32064/60000]
train_step:19361         loss: 0.057548  [38464/60000]
train_step:19461         loss: 0.019646  [44864/60000]
train_step:19561         loss: 0.066710  [51264/60000]
train_step:19661         loss: 0.060463  [57664/60000]
Test Error: 
 Accuracy: 99.0%, Avg loss: 0.029362

Epoch 22
-------------------------------
train_step:19699         loss: 0.010345  [   64/60000]
train_step:19799         loss: 0.079234  [ 6464/60000]
train_step:19899         loss: 0.029260  [12864/60000]
train_step:19999         loss: 0.012371  [19264/60000]
train_step:20099         loss: 0.031397  [25664/60000]
train_step:20199         loss: 0.009261  [32064/60000]
train_step:20299         loss: 0.039390  [38464/60000]
train_step:20399         loss: 0.023789  [44864/60000]
train_step:20499         loss: 0.092900  [51264/60000]
train_step:20599         loss: 0.055057  [57664/60000]
Test Error: 
 Accuracy: 99.0%, Avg loss: 0.028364

Epoch 23
-------------------------------
train_step:20637         loss: 0.014794  [   64/60000]
train_step:20737         loss: 0.053557  [ 6464/60000]
train_step:20837         loss: 0.028229  [12864/60000]
train_step:20937         loss: 0.025108  [19264/60000]
train_step:21037         loss: 0.044421  [25664/60000]
train_step:21137         loss: 0.021486  [32064/60000]
train_step:21237         loss: 0.049938  [38464/60000]
train_step:21337         loss: 0.035409  [44864/60000]
train_step:21437         loss: 0.058342  [51264/60000]
train_step:21537         loss: 0.053329  [57664/60000]
Test Error: 
 Accuracy: 99.0%, Avg loss: 0.027934

Epoch 24
-------------------------------
train_step:21575         loss: 0.005034  [   64/60000]
train_step:21675         loss: 0.056119  [ 6464/60000]
train_step:21775         loss: 0.026615  [12864/60000]
train_step:21875         loss: 0.017256  [19264/60000]
train_step:21975         loss: 0.011907  [25664/60000]
train_step:22075         loss: 0.009242  [32064/60000]
train_step:22175         loss: 0.037675  [38464/60000]
train_step:22275         loss: 0.010093  [44864/60000]
train_step:22375         loss: 0.125419  [51264/60000]
train_step:22475         loss: 0.032573  [57664/60000]
Test Error: 
 Accuracy: 99.1%, Avg loss: 0.027759

Epoch 25
-------------------------------
train_step:22513         loss: 0.003974  [   64/60000]
train_step:22613         loss: 0.040954  [ 6464/60000]
train_step:22713         loss: 0.011531  [12864/60000]
train_step:22813         loss: 0.004550  [19264/60000]
train_step:22913         loss: 0.013247  [25664/60000]
train_step:23013         loss: 0.010463  [32064/60000]
train_step:23113         loss: 0.049252  [38464/60000]
train_step:23213         loss: 0.017306  [44864/60000]
train_step:23313         loss: 0.051067  [51264/60000]
train_step:23413         loss: 0.025364  [57664/60000]
Test Error: 
 Accuracy: 99.1%, Avg loss: 0.027077

Done!
Time-consuming: 516.2311453819275 

Saved PyTorch CNN Model State to ./model/MNIST_CNN_model.pth
Predicted: "7", Actual: "7"
Finished